## Analysis for {{island}}


```{r}
#| echo: false
peng_data <- penguins |> 
    filter(species == params$species & island =="{{island}}")  |> 
    drop_na()

```

::: {#tbl-penguins-{{island}}}
```{r}
#| echo: false
modelsummary::datasummary(sex*(body_mass_g + bill_length_mm + bill_depth_mm)~(N+mean+sd), data=peng_data)

```
Summary statistics for penguins on {{island}}
:::

```{r}
#| echo: false
#| output: asis

text <- knitr::knit_expand(text = c(
  "```{r}",
  "#| echo: false",
  "#| label: fig-penguins-{{params$species}}-{{island}}",
  "#| fig-cap: 'Scatter plot of bill dimensions for penguins on {{island}}'",
  "ggplot(peng_data, aes(x=bill_length_mm, y=bill_depth_mm, fill=sex)) +",
  "  geom_point(shape=21, size=3, alpha=0.7) +",
  "  labs(",
  "    x = 'Bill Length (mm)',",
  "    y = 'Bill Depth (mm)'",
  "  )",
  "```"
))
res <- knitr::knit_child(text = text, quiet = TRUE)
cat(res, sep = "\n")
```

The summary statistics of penguins on {{island}} is given in @tbl-penguins-{{island}} and a scatter plot of bill dimensions is shown in @fig-penguins-{{island}}.

Next, we fit a linear model to predict bill depth from bill length and sex of the penguins on {{island}}. The results are summarized below in @tbl-model-{{island}}.

::: {#tbl-model-{{island}}}
```{r}
#| echo: false
model <- lm(bill_depth_mm ~ bill_length_mm+sex, data=peng_data)
modelsummary(model)
```
Regression results for penguins on {{island}}
:::
